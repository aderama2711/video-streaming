import { Component, Name } from "@ndn/packet";
import { defaultVersionConvention } from "./convention_node.js";
import { serve } from "./serve/mod_node.js";
export function serveVersioned(prefixInput, source, opts = {}) {
    let versionComp;
    const { version = Date.now() } = opts;
    if (typeof version === "number") {
        const { versionConvention = defaultVersionConvention } = opts;
        versionComp = versionConvention.create(version);
    }
    else {
        versionComp = Component.from(version);
    }
    const producerPrefix = new Name(prefixInput);
    const prefix = producerPrefix.append(versionComp);
    return serve(prefix, source, {
        ...opts,
        producerPrefix,
    });
}
